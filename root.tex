%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%2345678901234567890123456789012345678901234567890123456789012345678901234567890
%        1         2         3         4         5         6         7         8

\documentclass[letterpaper, 10 pt, conference]{ieeeconf}  % Comment this line out if you need a4paper

%\documentclass[a4paper, 10pt, conference]{ieeeconf}      % Use this line for a4 paper

\IEEEoverridecommandlockouts                              % This command is only needed if 
                                                          % you want to use the \thanks command

\overrideIEEEmargins                                      % Needed to meet printer requirements.

%In case you encounter the following error:
%Error 1010 The PDF file may be corrupt (unable to open PDF file) OR
%Error 1000 An error occurred while parsing a contents stream. Unable to analyze the PDF file.
%This is a known problem with pdfLaTeX conversion filter. The file cannot be opened with acrobat reader
%Please use one of the alternatives below to circumvent this error by uncommenting one or the other
%\pdfobjcompresslevel=0
%\pdfminorversion=4

% See the \addtolength command later in the file to balance the column lengths
% on the last page of the document

% The following packages can be found on http:\\www.ctan.org
\usepackage{graphics} % for pdf, bitmapped graphics files
\usepackage{epsfig} % for postscript graphics files
\usepackage{mathptmx} % assumes new font selection scheme installed
\usepackage{times} % assumes new font selection scheme installed
\usepackage{amsmath} % assumes amsmath package installed
\usepackage{amssymb}  % assumes amsmath package installed
\usepackage{mathtools}
\usepackage{relsize}
\usepackage{tikz}
\graphicspath{{./Drawings/Draw/}} 
\newcommand{\notimplies}{%
	\mathrel{{\ooalign{\hidewidth$\not\phantom{=}$\hidewidth\cr$\implies$}}}}
\usepackage[margin=0.8cm]{caption}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\usepackage{pgfplots}
\pgfplotsset{compat=newest}
\pgfplotsset{plot coordinates/math parser=false}
\newlength\figureheight
\newlength\figurewidth 
\usepackage{adjustbox}
\usepackage{indentfirst}

\newcommand*{\CC}{%
	\textsf{C\kern-1ex C}%
}
\newcommand*{\RR}{%
	\textsf{I\kern-.3ex R}%
}
\newcommand*{\ZZ}{%
	\textsf{Z\kern-1ex Z}%
}


\newtheorem{lemma}{Lemma}
\newtheorem{theorem}{Theorem}
\newtheorem{assumption}{Assumption}
\newtheorem{proposition}{Proposition}
\usepackage{lineno,amssymb,subcaption,algpseudocode,algorithm}


\setlength{\parindent}{15pt} % Default is 15pt.
\newcommand{\AB}[1]{\textbf{\color{magenta}{[AB: #1]}}}
\newcommand{\SK}[1]{\textbf{\color{blue}{[SK: #1]}}}
\newcommand{\SKN}[1]{\textbf{\color{red}{#1}}}
\newcommand{\smallmat}[1]{\left[ \begin{smallmatrix}#1 \end{smallmatrix} \right]}

\title{\LARGE \bf
Characterization of exogenous disturbance uncertainty sets and their application to robust model predictive control
}


\author{ Sampath Kumar Mulagaleti, Alberto Bemporad, and Mario Zanon % <-this % stops a space
\thanks{*This work was not supported by any organization}% <-this % stops a space
\thanks{Sampath Kumar Mulagaleti, Alberto Bemporad and Mario Zanon are with
		the IMT School for Advanced Studies Lucca, Piazza San Francesco 19,
		55100 Lucca, Italy. 
		 Email: 
	   {\tt\tiny \{s.mulagaleti,alberto.bemporad,mario.zanon\}@imtlucca.it}  }%%
}

\bibliographystyle{ieeetr}
\begin{document}



\maketitle
\thispagestyle{empty}
\pagestyle{empty}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{abstract}

Robust model predictive control (MPC) techniques require an explicit characterization of the uncertainty present within the model employed. Characterization of the uncertainty modeled as parameter variability has been discussed extensively in literature, but little is found with respect to characterization of uncertainty modeled as an exogenous disturbance signal. This paper proposes a method to do so, and presents a simple robust MPC scheme within which the characterization can be used. The techniques presented build on an AutoRegressive eXogenous (ARX) model of the plant being controlled, and borrow concepts from invariant set theory. Two control schemes are presented, with the second one being more conservative but less computationally heavy than the first. Numerical simulations are performed, and it is shown that the methods presented can provide robust constraint satisfaction and reduced conservatism in performance.

\end{abstract}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
Model predictive control schemes can be used to design controllers for systems with constraints. They work by making predictions of the future evolution of the system, and choose a control input that best minimizes an objective function while satisfying the constraints imposed. For making the predictions, a model of the plant is used. If the model does not represent the system exactly, the predictions are not accurate, which might result in the constraints being violated. To avoid this, robust model predictive control schemes have been proposed in literature. A review of the considerations to be made while developing such robust schemes can be found in \cite{10.1007/BFb0109870}.
 \\ \indent
 Robust MPC techniques use system models that are appended with uncertainty descriptions.
 These are explicit characterizations of the uncertainty present within the model. Such a characterization helps in establishing bounds on the predictions made by the model, such that the real performance of the system lies within these bounds. The robust model predictive controller should ensure constraint satisfaction for all possible predictions of the system evolution within these bounds. A popular approach is to use a linear model of the system being controlled, and a parametric multiplicative uncertainty description, keeping the parameters of the model within a bounded set $\mathbb{S}$. In \cite{KOTHARE19961361}, approaches to solve MPC problems with such uncertainty descriptions are presented. Alternatively, one can use a non-parametric uncertainty description by modeling the uncertainty as an unknown additive disturbance signal, lying within a bounded set $\mathbb{W}$. Robust tube-MPC approach presented in \cite{MAYNE2005219} guarantees robust constraint satisfaction for such non-parametric uncertainty description.
 \\
 \indent
 Using the parametric uncertainty description requires identifying the set $\mathbb{S}$ in which the parameters lie. A review of the methods to do so can be found in \cite{WALTER1990449}. In \cite{7330793}, a method to jointly identify an ARX model of the plant and the set $\mathbb{S}$ in which the model parameters lie is discussed. To the best of the authors' knowledge however, no work has been presented to identify the polyhedral sets $\mathbb{W}$ in which the bounded disturbances lie in case of non-parametric uncertainty description. This work aims to present one such method, along with a simple robust MPC scheme in which this uncertainty description can be employed. 
 \\
 \indent
 The approach discussed in this work is based on the identification of an ARX model of the plant, and re-uses the same dataset used for the identification to characterize model uncertainty. Following the assumption of zero measurement noise, the main idea is that the uncertainty in the identified model is equivalent to prediction error in ARX identification. The prediction error can be extracted out as a signal from the dataset used for the identification, and the identified ARX model can be manipulated to show that this signal is the output of a system driven by an external disturbance.
 Hence, obtaining the set $\mathbb{W}$ in which this disturbance signal lies is equivalent to characterizing model uncertainty. The methods to calculate this set are based on the theory of output admissible sets, as discussed in \cite{531239}.
 \noindent
 The robust MPC scheme within which the ARX model and the corresponding uncertainty description are used is based on reference governor approaches, a review of which is presented in \cite{Garone:2017:RCG:3032127.3032157}. It is noted that the set $\mathbb{W}$ can also be used in other robust MPC schemes accommodating such an uncertainty description.
 \\
 \indent
 The paper is organized as follows. In Section II, the problem we are tackling is introduced, and the open-loop ARX model on which the rest of the work is based is discussed. In Section III, formulation of the robust MPC controller is discussed, explicitly stating where the uncertainty set $\mathbb{W}$ is used within the formulation. Following this, in Section IV, methods to characterize this set $\mathbb{W}$ are presented, which is the main contribution of this work. Numerical simulations are presented in Section V, and conclusions and possible extensions to the work in Section VI.
 
\section{Problem Statement}
We consider a \textit{multi-input multi-output} plant $\mathbb{G}_P$, generating an output signal $y(t) \in  \RR^{n_y}$ corresponding to the input signal $u(t) \in\RR^{n_u}, t \in \ZZ^+$. We aim at synthesizing a controller that can make the output track a user-defined reference signal $r(t) \in  \RR^{n_y}$, while robustly respecting the polyhedral constraints $Hy(t) \leq h , t \in \ZZ^+$. Towards this end, we first perform an experiment to identify a model of the plant, the details of which are given in the following subsection. 
\subsection{Open-loop model identification}
An ARX model of the open-loop plant $\mathbb{G}_P$ is identified, which is parameterized as follows:
\begin{equation*} 
A(q^{-1})y(t)=B(q^{-1})u(t)+w(t)
\end{equation*}
where $q^{-1}$ is the backward shift operator.
For the identification, the dataset $D_N=\{u(k),y(k);k\in1,2,..,N\}$ obtained from open-loop experiments is utilized. Assuming the model is invertible, it is rewritten as
\begin{equation} 
y(t)=M(q^{-1})u(t)+D(q^{-1})w(t)
\label{tfmodel}
\end{equation}
where the transfer functions are $M(q^{-1})=B(q^{-1})/A(q^{-1})$ and $D(q^{-1})=1/A(q^{-1})$. Hence, the output $y(t)$ is the sum of outputs of two systems, a schematic of which is shown in Figure \ref{fig:fullloop}.
	\begin{figure}[h]
		\vspace{-3pt}
		\hspace{45pt}
		\includegraphics[scale = 01.1]{final_robust.pdf}
		\caption{ARX model}
		\label{fig:fullloop}
	\end{figure} \\
If the dataset $D_N$ is noise-free, the part $y_D(t)$ of the output $y(t)$ that the model $M(q^{-1})$ does not capture can be attributed to model uncertainty. Hence, the uncertainty can be modeled as an exogenous disturbance signal acting on the output. We incorporate the disturbance model $D(q^{-1})$ within the complete system model, resulting in the uncertainty arising from the exogenous disturbance input $w(t)$. Robust model-based control schemes can utilize this appended model for controller synthesis, provided the uncertainty set to which the exogenous disturbance signal $w(t)$ belongs is available. In the next section, one such control scheme is discussed. Following that, a method to obtain the set in which $w(t)$ lies is presented. It is noted that using a disturbance model $D(q^{-1})$ for controller synthesis is an approach similar to that followed for offset-free model predictive control, as discussed in \cite{doi:10.1002/aic.690490213}. However, since the focus is on extracting and utilizing the disturbance sets, no analysis of the offset-removing nature of the presented scheme is performed.
  \section{Robust controller design}
  For controller synthesis, we first
  convert the transfer functions in \eqref{tfmodel} to state space form, and obtain the following equations:
  \begin{equation} 
  \begin{matrix}
  \begin{bmatrix}
  x_M(t+1) \\ x_D(t+1)
  \end{bmatrix} = 
  \begin{bmatrix}
  A_M & 0 \\ 0 & A_D
  \end{bmatrix}
  \begin{bmatrix}
  x_M(t) \\ x_D(t)
  \end{bmatrix} + 
  \begin{bmatrix}
  B_M \\ 0
  \end{bmatrix}
  u(t)+ 
  \begin{bmatrix}
  0 \\ B_D
  \end{bmatrix}
  w(t) \\ \\
  y(t) = 
  \begin{bmatrix}
  C_M & C_D
  \end{bmatrix}
  \begin{bmatrix}
  x_M(t) \\ x_D(t)
  \end{bmatrix}
  + D_Mu(t) + D_Dw(t) 
  \end{matrix}
  \label{ssmodel}
  \end{equation}
  where the states $x_M(t)$ and $x_D(t)$ belong to the system model $M$ and the disturbance model $D$ respectively. 
  In a condensed way, they are written as:
  \begin{equation}
  \begin{matrix}
    x(t+1)=Ax(t)+B_Uu(t)+B_Ww(t) \\
    \hspace{18pt} y(t)=Cx(t)+D_Uu(t)+D_Ww(t) 
    \end{matrix} 
        \label{ssmodel_condensed}
    \end{equation}
    \begin{table*}[t]
    	\begin{equation}
    	\mathbb{O}_{N_P}= \begin{Bmatrix}
    	(x(t),\bar{u}):
    	\tilde{H}
    	\begin{pmatrix}
    	\begin{bmatrix}
    	CA \\ CA^2 \\ . \\ . \\ CA^{N_P}
    	\end{bmatrix}x(t) +
    	\begin{bmatrix}
    	CB_U+D_U \\ CAB_U+D_U \\ . \\ . \\ C\sum\limits_{j=0}^{N_P-1}A^{j}B_U + D_{U}
    	\end{bmatrix}\bar{u} + 
    	\begin{bmatrix}
    	CB_W & D_W & . & .  & 0 \\ CAB_W & CB_W & D_W & . & 0 \\ . \\ . \\ CA^{N_P-1}B_W & CA^{N_P-2}B_W & . & . & D_W
    	\end{bmatrix}
    	\begin{bmatrix}
    	w(t) \\ w(t+1) \\ . \\ . \\ w(t+N_P)
    	\end{bmatrix} 
    	\end{pmatrix}
    	\leq
    	\tilde{h}
    	\end{Bmatrix}
    	\label{full_ONP}
    	\end{equation}
    \end{table*}
  A robust controller is designed to provide a control input $u(t)$ that makes the output $y(t)$ 
  track a reference signal $r(t)$. At each time step $t$, the controller obtains the current state $x(t)$ and solves the optimization problem:
  	\begin{equation}
  	\small
  	\begin{aligned}
  	\underset{\bar{u}}{\text{min}}
  	&  \hspace{20pt} \mathlarger{\sum\limits_{k=1}^{N_P}}\norm{\hat y(t+k)-r(t+k)}_2^2 \\
  	\text{subject to}
  	%\begin{matrix}
  	& \hspace{20pt} \hat{x}(t+k+1) = A\hat{x}(t+k) + B_U\bar{u}\\
  	& \hspace{20pt} \hat y(t+k) = C\hat{x}(t+k) + D_U\bar{u} \\
  	& \hspace{20pt} \hat{x}(t)=x(t) \\
  	& \hspace{20pt} (x(t),\bar{u}) \in \mathbb{O}_{N_P}
  	%	& \hspace{20pt} Hy_{\gamma}(t) \leq h \mbox{\AB{I think $Hy_{\gamma}(t)\leq h$ is redundant}}\\
  	%	& \hspace{20pt}  g(t+k) \in \mathbb{G}_{N_P}(\gamma(t)) \\
  	%\end{matrix}
  	\end{aligned}
  	\label{RMPC}
  	\end{equation}
  It calculates a constant control input $\bar{u}$ which is feasible with respect to the output admissible set $\mathbb{O}_{N_P}$ of the system \eqref{ssmodel} defined as:
  \begin{equation}
  \begin{matrix}
  \mathbb{O}_{N_P} = \{(x(t),\bar{u}):y\in \mathbb{Y}, u(t+k)=\bar{u},\forall w \in \mathbb{W}  \\ \hspace{150pt} \forall k \in \{0,1,..,N_P-1\} \}
  \end{matrix}
  \label{O_form}
  \end{equation}
  where $y \in \mathbb{Y}$ denotes the future output sequence $\{y(t+k),k=1,..,N_P\}\in\mathbb{Y}$
  and $w \in \mathbb{W}$ denotes the future disturbance sequence $\{w(t+k),k=0,..,N_P\}\in\mathbb{W}$.
  $\mathbb{O}_{N_P}$ is the set of initial states $x(t)$ and a constant control input $\bar{u}$ such that the future output trajectory of the system does not violate the constraints defined by $\mathbb{Y}$ for any possible bounded disturbance sequence $w\in\mathbb{W}$, within the horizon time $N_P$. It can also be seen as an $N_P$-step reachable set from a single point initial state set $\{x(t)\}$ and a constant control input $\bar{u}$, subject to bounded disturbances in $\mathbb{W}$. More details are discussed in \cite{Predictivecontrol}. It is noted that the presented scheme is similar to the robust predictive control scheme in \cite{CHISCI20011019}. The main difference is that in our case, there is no requirement for the controller to reduce to a predetermined linear state-feedback form when the output constraints are satisfied.
  \\
  At any future time instant $t+k$, given the initial state $x(t)$ and a constant control input $\bar{u}$, the output $y(t+k)$ is given by:
  	\begin{equation}
  	\hspace{-30pt}
  	\begin{aligned}
  	\begin{matrix}
  	y(t+k) = CA^{k}x(t) + \bigg( C\sum\limits_{j=0}^{k-1}A^{j}B_U + D_{U} \bigg)\bar{u} + \vspace{5pt}\\  \hspace{110pt} C\sum\limits_{j=0}^{k-1}A^jB_Ww(t+k-1-j) + D_{W} w(t+k)
  	\end{matrix}
  	\end{aligned}
  	\label{elongform}
  	\end{equation}
  	It is desired to constraint the output $y(t+k)$ at a time instant $t+k$ within the polyhedral set $Hy(t+k) \leq h, h \in I\!R^{n_c}$.
  The output constraint set $\mathbb{Y}$ represents a collection of these pointwise in time constraints, and is written as:
  \begin{equation*}
  \small
  \mathbb{Y}=\begin{Bmatrix}y:
  \begin{bmatrix}
  H & . & . & 0 \\
  . & H & . & .\\
  . & . & . & . \\
  0 & . & . & H
  \end{bmatrix}
  \begin{bmatrix}
  y(t+1) \\ . \\ . \\ y(t+N_P)
  \end{bmatrix}
  \leq \begin{bmatrix}
  h \\ . \\ . \\  h
  \end{bmatrix}
  \end{Bmatrix} = 
  \{ y: \tilde{H} y \leq \tilde{h} \}
  \end{equation*}
  \iffalse
  Defining the set $\mathbb{O}_k=\{(x(t),\bar{u}):Hy(t+k)\leq h\ \forall w \in \mathbb{W}\}$, the desired set $\mathbb{O}_{N_P}$ can be written as:
  \begin{equation*}
  \mathbb{O}_{N_P}=\bigcap^{N_P}_{k=1} \mathbb{O}_k
  \end{equation*}
  \fi
  Hence, the definition of set $\mathbb{O}_{N_P}$ in \eqref{O_form} can be rewritten as:
   \begin{equation}
   \begin{matrix}
   \mathbb{O}_{N_P} = \{(x(t),\bar{u}):\tilde{H}y\leq \tilde{h},  u(t+k)=\bar{u},\forall w \in \mathbb{W}  \\ \hspace{150pt} \forall k \in \{0,1,..,N_P-1\} \}
   \end{matrix}
   \label{O_form}
   \end{equation}
Using the form in  \eqref{elongform}, the constraints can be enumerated as shown in \eqref{full_ONP}. It is written in a simplified notation as:
\begin{equation}
\mathbb{O}_{N_P}= \begin{Bmatrix}
(x(t),\bar{u}):
\tilde{H}
\begin{pmatrix}
H_xx(t) +
H_u\bar{u} +  
H_w
w
\end{pmatrix}
\leq
\tilde{h}
\end{Bmatrix}
\label{O_set}
\end{equation}
Since the output feasibility should hold over all possible future disturbance sequences, we desire to calculate the set
\begin{equation}
\mathbb{O}_{N_P}=\{(x(t),\bar{u}): 	H_xx(t) +
H_u\bar{u}\in \mathbb{Y} \sim H_w\mathbb{W}\}
\label{Minkowski}
\end{equation}
where $\sim$ denotes P-subtraction of sets. Towards this end, we first rewrite \eqref{O_set} as: 
  \begin{equation}
  \begin{matrix}
  \hspace{-25pt}
  \mathbb{O}_{N_P}= \begin{Bmatrix}
  (x(t),\bar{u}):
  G_x(t) +
  G_u\bar{u} +  
  G_w
  w
  \leq
  \tilde{h}
  \end{Bmatrix}
  \\
  \hspace{20pt}
 = \begin{Bmatrix}
  (x(t),\bar{u}):
	G_x(t) +
  G_u\bar{u} +  
  \begin{bmatrix}
  G^1_w \\ . \\ . \\ G^{n_cN_P}_w
  \end{bmatrix}
  w
  \leq
  \begin{bmatrix}
  h_Y^1 \\ . \\ . \\ h_Y^{n_cN_P}
  \end{bmatrix}
  \end{Bmatrix}
  \end{matrix}
  \end{equation}
  where $G_x=\tilde{H}H_x$, $G_u=\tilde{H}H_u$ and $G_w=\tilde{H}H_w$.
  Row $i$ of the matrix $G_w$ is denoted as $G^i_w$, and element $i$ of the vector $\tilde{h}$ is denoted as $h_Y^i$.
   For polyhedral sets like in our case, performing P-subtractions results in the set:
  \begin{equation}
  \begin{matrix}
  \mathbb{O}_{N_P} = \{ (x(t),\bar{u}):G_xx(t)+G_u\bar{u}\leq h_{YW} \} \vspace{5pt} \\ 
  h_{YW}^i = h_Y^i-\underset{w\in \mathbb{W}}{\text{sup}} G_w^i w
  \end{matrix}
  \label{overall}
  \end{equation}
  where $h_{YW}^i$ is the element $i$ of the vector $h_{YW}$. If $A$ is Schur stable, as $N_P$ increases, the constraints added to $\mathbb{O}_{N_P}$ become redundant after a finite value of $N_P$. This is due to the finite-termination property of maximal output admissible positive invariant sets \cite{531239}.
  \\
Hence, to calculate the set $\mathbb{O}_{N_P}$, we need the disturbance sequence set $\mathbb{W}$. The calculation of this set is discussed in the next section.
  \section{Calculation of $\mathbb{W}$}
  \noindent
  As discussed earlier, the part $y_D(t)$ of the output $y(t)$ represents uncertainty modeled as an exogenous disturbance signal. It is generated by the model $D(q^{-1})$, whose state-space equations are written as 
  \begin{equation}
  \begin{matrix}
  x_D(t+1) = A_Dx_D(t)+B_Dw(t)  \\ \hspace{17pt}
  y_D(t) = C_Dx_D(t)+D_Dw(t)
  \end{matrix}
  \label{ssD}
  \end{equation}
  A sample data set $U_N$ of $y_D(t)$ can be obtained from $D_N$, by simulating the model $M(q^{-1})$ with the input signals $u(k)$, as:
  \begin{equation}
  U_N=\{y_D(k)=y(k)-M(q^{-1})u(k);k \in 1,2,..,N\}
  \end{equation}
  \begin{table*}[t]
   \begin{equation}
   \mathbb{O}_{N_P}^D=\begin{Bmatrix}(x_D(t),w):\tilde{H}_D\begin{pmatrix}\begin{bmatrix} C_DA_D\\ C_DA_D^2 \\ . \\ . \\ C_DA_D^{N_P}\end{bmatrix}x_D(t) + \begin{bmatrix}
   C_DB_D & D_D & . & . & 0 \\
   C_DA_DB_D & C_DB_D & D_D & . & 0 \\
   . &  &  &  & . \\
   . &  &  &  & . \\
   C_DA_D^{N_P-1} & . & . & . & D_D
   \end{bmatrix}
   \begin{bmatrix}
   w(t) \\ w(t+1) \\ . \\ . \\ w(t+N_P)
   \end{bmatrix}
   \end{pmatrix} \leq \tilde{h}_D
   \end{Bmatrix}
   \label{OND_set}
   \end{equation} 
  \end{table*}
    From $U_N$, we aim to construct a set in which the corresponding input signal $\{w(k);k \in 1,2,..,N\}$ lies. It is noted that one cannot just reconstruct the signal $\{w(k);k \in 1,2,..,N\}$ by inverting $D(q^{-1})$, since the initial condition of $D(q^{-1})$ is unknown.
    To calculate the input signal set,
 first an outer bounding convex polyhedral set $\mathbb{Y}_D^N$ is constructed that encompasses the whole dataset $U_N$. As the number of data points in the experiment increases, we obtain $\mathbb{Y}_D^{N} \subseteq \mathbb{Y}_D^{N+1}$ as
 $\mathbb{Y}_D^{N} = conv(U_N)$ and  $\mathbb{Y}_D^{N+1} = conv(U_{N+1})=conv(U_{N} \cup \{y_D(N+1)\} )$, where $conv(X)$ is the convex hull of the set of elements within $X$. 
  \begin{assumption}
  	The ARX model has been identified with an informative data set $D_N$ and the model structure chosen is identifiable.
  	\label{assmp_arx}
  \end{assumption} 
 \begin{assumption}
 	 In the limit of infinite data used to build $U_N$, the outer encompassing sets $\mathbb{Y}_D^{N}$ converge to a steady set $\mathbb{Y}_D^{\infty}$.
 	 \label{assmp_inf}
 \end{assumption} 
  Assumption \ref{assmp_inf} is reasonable if the underlying plant and the identified model are both stable, since they would lead to bounded sample data $y(k)$ and $M(q^{-1})u(k)$ respectively, and the subtraction of bounded data results in bounded data. Following Assumption \ref{assmp_arx}, the infinite data would be informative, resulting in the identification being performed for all possible excitations of the plant.  Hence, the dataset $U_{\infty}$, based on which $\mathbb{Y}_D^{\infty}$ is constructed will consist of bounded data containing all possible disturbance samples. Thus, it is the largest set within which every possible exogenous disturbance $y_D(t)$ lies. That is, $y_D(t) \in \mathbb{Y}_D^{\infty} \hspace{2pt}  \forall t \in \ZZ^{+}$. \\
\noindent
In a polyhedral form, this set defining the point wise in time values of $y_D(t)$ is written as $\mathbb{Y}_D^{\infty} = \{y_D(t):H_Dy_D(t) \leq h_D \forall t \in \ZZ^+\}$. \\
 Since $y_D(t)$ lies within $\mathbb{Y}_D^{\infty}$ at each time instant $t$, we can define a sequence $y_D \in \mathbb{Y}_D$ starting from time instant $t$ and going $N_P$ time steps into the future $\{y_D(t+k),k=1,..,N_P\}\in\mathbb{Y}_D$ as:
 \begin{equation}
 \small
 \begin{matrix}
 \mathbb{Y}_D=\begin{Bmatrix}y_D:
 \begin{bmatrix}
 H_D & . & . & 0 \\
 . & H_D & . & .\\
 . & . & . & . \\
 0 & . & . & H_D
 \end{bmatrix}
 \begin{bmatrix}
 y_D(t+1) \\ . \\ . \\ y_D(t+N_P)
 \end{bmatrix}
 \leq \begin{bmatrix}
 h_D \\ . \\ . \\  h_D
 \end{bmatrix}
 \end{Bmatrix} 
 \\ \\
 \hspace{-120pt}
 = 
 \{ y_D: \tilde{H}_D y \leq \tilde{h}_D \}
 \end{matrix}
 \label{YD_set}
 \end{equation} 
At any future time instant $t+k$ from the current time instant $t$, given the model \eqref{ssD} and initial condition $x_D(t)$, the output $y_D(t+k)$ can be written as:
\begin{equation}
\small
\begin{matrix}
y_D(t+k)=C_DA_D^{k}x_D(t)+ C_D\sum\limits_{j=0}^{k-1}A_D^jB_Dw(t+k-1-j)+D_Dw(t+k) \\
\end{matrix}
\label{expanded_xD}
\end{equation}
Similar to before, we construct a set $\mathbb{O}^D_{N_P}$ defined as:
  \begin{equation}
  \begin{matrix}
  \mathbb{O}^D_{N_P} = \{(x_D(t),w):y_D\in \mathbb{Y}_D\}  \\
    \hspace{32pt} = \{(x_D(t),w):\tilde{H}_Dy_D \leq \tilde{h}_D\} 
  \end{matrix}
  \label{O_D_form}
  \end{equation}
  This is the set of initial conditions $x_D(t)$ and exogenous disturbance input sequence $w=\{w(t+k),k \in 0, 1, .., N_P\}$, such that the output of the system \eqref{ssD} always stays inside the set defined by \eqref{YD_set}. Like $\mathbb{O}_{N_P}$, $\mathbb{O}_{N_P}^D$ is an $N_P$-step reachable set, from a given point $x_D(t)$ and every possible input sequence $w$.
  Using the prediction of the output given by \eqref{expanded_xD} in \eqref{O_D_form}, 
  the set $\mathbb{O}_{N_P}^D$ can be written as \eqref{OND_set}, which is rewritten in \eqref{condensed_OND} as:
  \begin{equation}
  \mathbb{O}_{N_P}^D=\{(x_D(t),w): \tilde{H}_D(H_x^Dx_D(t)+H_w^Dw) \leq \tilde{h}_D\}
  \label{condensed_OND}
  \end{equation}
  Hence, given an initial condition $x_D(t)=x_D$, we can calculate the set $\mathbb{W}(x_D)$ as:
  \begin{equation}
  \begin{matrix}
  \mathbb{W}(x_D) = \{w: \tilde{H}_DH_w^Dw \leq \tilde{h}_D-\tilde{H}_DH_x^Dx_D\} \\
  \hspace{-20pt}
   = \{w: Gw \leq g_x(x_D)\}
   \end{matrix}
   \label{w_xd_set}
  \end{equation}
  This is the largest set in which the disturbance input sequence $\{w(t+k),k \in 0,1,..,N_P\}$ can lie in, such that the corresponding output sequence $\{y_D(t+k),k \in 1,..,N_P\}$ always lies within \eqref{YD_set}. In other words, it is the set in which the input sequence of the $N_P$-step reachable set $\mathbb{O}_{N_P}^D$ must lie such that it is output-admissible with respect to $\mathbb{Y}_D$, given an initial state point $x_D(t)$.
   \begin{assumption}
   The set $\mathbb{O}_{N_P}$ as defined in \eqref{Minkowski} is non-empty for $\mathbb{W}=\mathbb{W}(x_D(t))$ for all possible $x_D(t)$.
   \label{assmp_nonEmpty}
   \end{assumption}
     \noindent 
  This assumption is reasonable if the size of the set $\mathbb{Y}_D$ is \textit{small} compared to $\mathbb{Y}$, and hence is based on how good the ARX model identification is.\\\indent
  To calculate the input feasible set $\mathbb{O}_{N_P}$ by solving the equations in \eqref{overall}, we need the initial state $x(t)$ of the system \eqref{ssmodel}, which includes $x_D(t)$. We can use this to first calculate the corresponding disturbance sequence set $\mathbb{W}(x_D)$, and set $\mathbb{W}=\mathbb{W}(x_D)$. Following this, we calculate the set $\mathbb{O}_{N_P}$ as shown in \eqref{overall}. If Assumption \ref{assmp_nonEmpty} holds, the MPC scheme \eqref{RMPC} calculates the optimal control input $\bar{u}$. This procedure is summarized in Algorithm \ref{alg:mpc_wLP}.
   \algblockdefx[Name]{Repeat}{Until}[1][Unknown]{\textbf{Repeat} #1}{\textbf{Until }}
   \begin{algorithm}[t]
   	\caption{Robust MPC scheme}\label{alg:mpc_wLP}
   	\begin{algorithmic}[1]
   		\Repeat[every sampling instant:  $t=0,1,\ldots$]
   		\State Read current state $x(t)$, set $x_D = x_D(t)$
   		\State Calculate $\mathbb{W}(x_D)$ according to \eqref{w_xd_set}, set $\mathbb{W}=\mathbb{W}(x_D)$
   		\State Solve the linear programs in \eqref{overall} to obtain $\mathbb{O}_{N_P}$
   		\State Use $\mathbb{O}_{N_P}$ in \eqref{RMPC} to obtain control input $\bar{u}$
   		\State Apply $\bar{u}$ to the plant
   		\Until end of run
   	\end{algorithmic}
   \end{algorithm}
\\
\indent
  It should be noted that according to Algorithm \ref{alg:mpc_wLP}, at each time step $t$, $n_cN_P$ linear programs in \eqref{overall} should be solved for the worst case disturbance sequences of $w$, before solving the quadratic program \eqref{RMPC}. To reduce this online computation, it is desirable to calculate the sets $\mathbb{W}$ and $\mathbb{O}_{N_P}$ offline. 
  \\ \indent
  To calculate these sets offline, we first define the set $\mathbb{X}^D = \{x_D: G^D_xx_D \leq g^D_x\}$. This is the set of all the initial states that the disturbance block with state-space model \eqref{ssD} can have. If the state-space model \eqref{ssD} is a non-minimal realization of the I/O model $y_D(t) = D(q^{-1})w(t)$, the state vector $x_D(t)$ at any time instant $t$ is a collection of the previous outputs $y_D(t)$. This is because the model $D(q^{-1})= 1/A(q^{-1})$ means that there is no dependence of current output $y_D(t)$ on past input sequence $\{w(k),k < t\}$. Following Assumption \ref{assmp_inf}, if we can build the set $\mathbb{Y}_D^{\infty}$ in which the output $y_D(t)$ can lie at any instant of time $t$, construction of the corresponding set $\mathbb{X}^D$ is done as discussed in Appendix A. Upon construction of $\mathbb{X}^D$, we can define the disturbance sequence set $\mathbb{W}_{\Omega}$ as:
  \\
  \begin{equation}
  \begin{matrix}
  \hspace{-130pt}
  \mathbb{W}_{\Omega} = \text{proj}_w(\mathbb{O}_{N_P}^D)
  \vspace{5pt}
  \\
  \hspace{20pt}
  =\{w: \exists x_D(t) \in \mathbb{X}^D : \tilde{H}_D(H_x^Dx_D(t)+H_w^Dw) \leq \tilde{h}_D\}
  \end{matrix}
  \label{proj_set}
  \end{equation}
  This is the set in which the input sequence of the $N_P$-step reachable set $\mathbb{O}_{N_P}^D$ must lie such that it is output-admissible with respect to $\mathbb{Y}_D$, given an initial state lying anywhere in the feasible set $\mathbb{X}^D$.
  By setting $\mathbb{W}=\mathbb{W}_{\Omega}$ in \eqref{overall}, the set $\mathbb{O}_{N_P}$ can be constructed offline. This set can then be used to calculate the optimal control input $\bar{u}$ by solving \eqref{RMPC}. These steps are summarized in Algorithm \ref{alg:mpc_proj}.
  \algblockdefx[Name]{Repeat}{Until}[1][Unknown]{\textbf{Repeat} #1}{\textbf{Until }}
  \begin{algorithm}[t]
  	\caption{Robust MPC scheme with projected set}\label{alg:mpc_proj}
  	\begin{algorithmic}[1]
  		\State Compute $\mathbb{X}^D$ from $\mathbb{Y}_D^{\infty}$
  		\State Perform set projection to compute $\mathbb{W}_{\Omega}$ according to \eqref{proj_set}
  		\State Set $\mathbb{W}=\mathbb{W}_{\Omega}$, compute $\mathbb{O}_{N_P}$ according to \eqref{overall}
  		\Repeat[every sampling instant:  $t=0,1,\ldots$]
  		\State Read current state $x(t)$
  		\State Use $\mathbb{O}_{N_P}$ in \eqref{RMPC} to obtain control input $\bar{u}$
  		\State Apply $\bar{u}$ to the plant
  		\Until end of run
  	\end{algorithmic}
  \end{algorithm}
  \begin{proposition}
  	Using Algorithm \ref{alg:mpc_proj} instead of Algorithm \ref{alg:mpc_wLP} to compute $\bar{u}$ results in conservative controller performance.
  \end{proposition}
\hspace{4pt}
  \textit{Proof:}
  Let $\mathbb{O}_{N_P}^1$ and $\mathbb{O}_{N_P}^2$ be the two polyhedral sets constructed in Algorithm \ref{alg:mpc_wLP} and Algorithm \ref{alg:mpc_proj} respectively. If Assumption \ref{assmp_nonEmpty} holds, the set $\mathbb{O}_{N_P}^2$ is non-empty.
  By construction, $\mathbb{W}(x_D(t)) \subseteq \mathbb{W}_{\Omega} \hspace{2pt} \forall x_D(t) \in \mathbb{X}^D$. This means that in \eqref{overall}, 
  \begin{equation}
  \underset{w\in \mathbb{W}(x_D(t))}{\text{sup}} G_w^i w \leq  \underset{w\in \mathbb{W}_{\Omega}}{\text{sup}} G_w^i w \hspace{10pt} \forall x_D(t) \in \mathbb{X}^D
  \end{equation}
  Since $G_x$ and $G_u$ in \eqref{overall} are the same for $\mathbb{O}_{N_P}^1$ and $\mathbb{O}_{N_P}^2$, $\mathbb{O}_{N_P}^2 \subseteq \mathbb{O}_{N_P}^1 \forall x_D(t) \in \mathbb{X}^D$.
  Hence, a feasible solution $\bar{u}$ exists when \eqref{RMPC} is solved, but it belongs to a smaller set resulting in a conservative solution.\hfill\QED  \\
  \iffalse
  This conservativeness arises because on propagating the system \eqref{expanded_xD} with initial condition $x_D(t) \in \mathbb{X}^D$, the corresponding output sequence set is $y_D \in \mathbb{Y}_D^{\Omega}  \supseteq  \mathbb{Y}_D$. 
  \fi
  In the next section, the presented methods are implemented as numerical simulations and compared.
  \iffalse
 {\color{blue}{Ideas: Say first N data points are collected. An outer bounding polyhedral set $\mathbb{Y}^D_N$ is calculated, that encompasses all the points in $U_N$. Now, every point in $U_N$ lies in this set. As the number of data points increase, we will obtain for sure $\mathbb{Y}^D_{N} \subseteq \mathbb{Y}^D_{N+1}$. Assuming we have infinite data, we have the largest set $\mathbb{Y}^D_{\infty}$ in which every possible $y_D(t)$ will lie. Let $\mathbb{Y}_{\infty}^D$ be a polyhedron $H_Dy_D(t) \leq h_D$. Then, starting at a timestep $t$, if we define $y_D \in \mathbb{Y}_D$ as the sequence $\{y_D(t+k)\in\mathbb{Y}_D,k=1,..,N_P\}$, we can write the set $\mathbb{Y}_D$ as:
 		  \begin{equation*}
 		  \small
 		  \mathbb{Y}_D=\begin{Bmatrix}y_D:
 		  \begin{bmatrix}
 		  H_D & . & . & 0 \\
 		  . & H_D & . & .\\
 		  . & . & . & . \\
 		  0 & . & . & H_D
 		  \end{bmatrix}
 		  \begin{bmatrix}
 		  y_D(t+1) \\ . \\ . \\ y_D(t+N_P)
 		  \end{bmatrix}
 		  \leq \begin{bmatrix}
 		  h_D \\ . \\ . \\  h_D
 		  \end{bmatrix}
 		  \end{Bmatrix} = 
 		  \{ y_D: \tilde{H}_D y \leq \tilde{h}_D \}
 		  \end{equation*} 
 		  \\
	From this, we can expand in the same way by leaving the w sequence as it is. This will lead to a very similar set of equations. 
 		  }}
	which at each time instant $k$ is indicated as lying in a polyhedral set
	\begin{equation}
	y_D(k) \in \mathbb{Y}^D_N = \{y_D:H_Dy_D \leq h_D\}
	\end{equation}
	In the limit of infinite data $D_N$, the set $\mathbb{Y}_N^D$ approaches the actual exogenous disturbance output set $\mathbb{Y}_{\infty}^D$. Using this set, which is the output constraint set of the system described by Eq.\eqref{ssD}, we calculate $\vec{\mathbb{W}}(x_D(t))$ at each time instant $t$. It is the set in which the sequence of disturbance inputs $\{w(t+k):k=0:N_P\}$ should lie in, such that the output constraint $\{y_D(t+k)\in \mathbb{Y}_{\infty}^D:k=0:N_P\}$ of the disturbance model are respected. \\
	To calculate $\vec{\mathbb{W}}(x_D(t))$, we write the predicted output $y_D(t+k)$ of the disturbance model given the initial state $x_D(t)$ as:
	\begin{equation}
	\small
	\begin{matrix}
	y_D(t)=C_Dx_D(t)+D_Dw(t) \text{ if } k=0 \vspace{5pt} \\
	y_D(t+k)=C_DA_D^{k}x_D(t)+ C_D\sum\limits_{j=0}^{k-1}A_D^jB_Dw(t+k-1-j)+D_Dw(t+k) \\ \hspace{150pt}\text{ if } k>0
	\end{matrix}
	\end{equation}
    Collecting the disturbance input sequences  $\{w(t+k):k=1:N_P\}$ in a vector $\vec{w}$, the set $\vec{\mathbb{W}}(x_D(t))$ can be written as:     
    Hence, at each time step $t$, the state of the disturbance model $x_D(t)$ can be read, and the corresponding disturbance input set $\vec{\mathbb{W}}(x_D(t))$ can be calculated. Following this, the linear programs in  Eq.\eqref{overall}, which are rewritten as follows are solved:
    \begin{equation}
    h_{YW}^i = h_Y^i-\underset{\vec{w}\in \vec{\mathbb{W}}(x_D(t))}{\text{sup}} H_w^i \vec{w}  
    \end{equation}     
    Hence, the output admissible set $\mathbb{O}_{N_P}$ is obtained, which is used in the controller solving the optimization problem described in Eq.\eqref{RMPC} to calculate a robust optimal control input $\bar{u}$.
    \\
    {\color{blue} Following this, write it in an algorithmic form, and write conditions for which the set $\mathbb{O}_{N_P}$ will be non-empty. (Something about the size of $\mathbb{W}$ set . )
}
\section{Using the projected set}
Instead of solving so many LPs before a QP, we can project the set $\mathbb{W}$. For this, we need the set within which the state of the disturbance block can lie. This is possible to be obtained if we use a non-minimum realization as the state space model. When we have that, we can project within that subset and get a much more conservative thing. 
Have to write a theorem that projection is a good idea : The obtained set is larger than the original. Assumption that origin lies with W or something, so that it is feasible. Proof by doing minkowski difference : Sup over a larger feasible set leads to a larger number : But that should not break the feasibility of MPC.
    
    \fi
\section{Numerical simulations}
Two numerical examples are presented. In the first one, the plant $\mathbb{G}_P$ is a 2-input 2-output linear system with randomly varying parameters. The presented algorithms are implemented and constraint satisfaction is demonstrated.  In the second example, $\mathbb{G}_P$ represents a discrete time 2-input 2-output non-linear system. The uncertainty sets are extracted according to the methods presented, and are used in a robust open-loop minmax MPC controllers. The improvement in performance on using the disturbance model $D(q^{-1})$, as opposed to considering uncertainty only as an output noise is demonstrated, thus providing an argument to prefer using the uncertainty sets on $w(t)$ over $y_D(t)$ for controller synthesis. The controllers are implemented using YALMIP \cite{Lofberg2004}, utilizing its robust optimization framework.
\subsection{Linear parameter varying plant}
Numerical simulations are performed on the following uncertain linear system to evaluate the approaches mentioned:
\iffalse
\begin{equation}
\small
\begin{matrix}
\begin{bmatrix}
\dot{x} \\ \ddot{x} \\ \dot{y} \\ \ddot{y} 
\end{bmatrix} = 
\begin{bmatrix}
0 & 1 & 0 & 0 \\
-K/m & -b/m & 0 & 0 \\
0 & 0 & 0 & 1 \\
0 & 0 & -K/m & -b/m
\end{bmatrix}
\begin{bmatrix}
x \\ \dot{x} \\ y \\ \dot{y} 
\end{bmatrix} + 
\begin{bmatrix}
0 & 0\\
1/m & 0 \\
0 & 0 \\
0 & 1/m
\end{bmatrix}
\begin{bmatrix}
F_x \\ F_y
\end{bmatrix}  
\vspace{2pt} 
\\
\begin{bmatrix}
x \\ y 
\end{bmatrix} =
\begin{bmatrix}
1 & 0 & 0 & 0\\
0 & 0 & 1 & 0
\end{bmatrix}
\begin{bmatrix}
x \\ \dot{x} \\ y \\ \dot{y} 
\end{bmatrix}
\end{matrix}
\end{equation}
\fi
\begin{equation}
\small
\begin{matrix}
\mathbb{G}_P : \Bigg\{ & \hspace{-5pt}
\begin{matrix}
\dot{x} = A_ux+B_uu \\
y = \begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix} x 
\end{matrix}
\end{matrix}
\end{equation}
with the parameters varying randomly every sampling instant between:
\begin{table}[h!]
	\hspace{50pt}
	\begin{tabular}{||c|c||} 
		\hline
		Parameter & Range \vspace{1pt}\\ [0.5ex] 
		\hline
		$A_u$ & $\begin{bmatrix} -3 & 3 \\ 6 & -9 \end{bmatrix}$ - 
		$\begin{bmatrix} -2.9 & 3.1 \\ 6.1 & -8.9 \end{bmatrix}$  \vspace{1pt}\\
		$B_u$ & $\begin{bmatrix} 2 & 2 \\ 1.8 & 2.2 \end{bmatrix}$ - 
		$\begin{bmatrix} 2.05 & 2.05 \\ 1.85 & 2.25 \end{bmatrix}$  \\
		\hline
	\end{tabular}
	\label{Simparam}
	\vspace{-10pt}  
\end{table}
\\
Experiments are performed to identify a discrete time MIMO-ARX model of the system, by building the dataset $D_N$ with $N=10000$ sampled at $0.1s$. For simulation, the system is integrated using the $4^{th}$ order Runge-Kutta method.
The models $M(q^{-1})$ and $D(q^{-1})$ are computed, as shown in \eqref{tfmodel}, from which non-minimum realization state space models in \eqref{ssmodel} are extracted. A horizon of $N_P=5$ is set in \eqref{RMPC}. The set $\mathbb{Y}_D^{N}$ is shown in Figure \ref{Y_D^inf}. Instead of a convex hull, a polyhedral approximation of an outer ellipsoidal set is taken. 
	\begin{figure}[h]
		\hspace{30pt}
		\includegraphics[scale=0.6]{Y_D_set.eps}
		\caption{Set $\mathbb{Y}_D^N$ obtained from $U_N$ with $y_D(t) \in \RR^{2}$}
		\label{Y_D^inf}
	\end{figure} 
It is assumed that $\mathbb{Y}_D^{\infty}=\mathbb{Y}_D^N$, following which the set $\mathbb{Y}_D$ is calculated, followed by the construction of $\mathbb{O}_{N_P}^D$. The state $x_D(t)$ of the non-minimum realization state-space model \eqref{ssD} is updated using past outputs at each time-step $t$, and the state $x_M(t)$ is updated only using the dynamics of the model.
\\
\indent
In order to implement Algorithm \ref{alg:mpc_proj}, first the set $\mathbb{X}^D$ is constructed from $\mathbb{Y}_D^{\infty}$, following which the set $\mathbb{W}_{\Omega}$ is calculated by projecting $\mathbb{O}_{N_P}^D$ onto the $w$ coordinates. This set-projection operation was performed using the $projection$ function within the multi-parameteric toolbox \cite{mpt}. 
	\begin{figure}[h]
		\vspace{-3pt}
		\hspace{20pt}
		\includegraphics[scale=0.6]{output_performance.eps}
		\caption{Comparison of plant output trajectories. Gray area is the output constraint set $\mathbb{Y}$.}
		\label{fig:y_trajectories}
	\end{figure} 
	\vspace{-8pt} 
The output trajectories upon implementation of both the algorithms are compared in Figure \ref{fig:y_trajectories}, for different realizations of plant uncertainty. It can be seen that in both the cases, the trajectories remain within the constraint set $\mathbb{Y}$. As stated in Proposition 1, it can be seen that the output trajectory resulting from Algorithm \ref{alg:mpc_proj} is conservative with respect to the constraint set as compared to Algorithm \ref{alg:mpc_wLP}. 
\subsection{Non-linear plant}
A MIMO discrete time non-linear plant $\mathbb{G}_P$ described by the following non-linear equations is considered:
\begin{equation}
\small
\begin{matrix}
y_1(t) = 0.1y_1(t-1)-0.1y_2(t-1)+u_1(t-1)\\\hspace{30pt}-u_2(t-1)+0.01y_1(t-1)u_2(t-1) \\ \vspace{-5pt}\\
y_2(t) = 0.1y_2(t-1)-0.1y_1(t-1)+u_1(t-1)\\\hspace{30pt} +u_2(t-1)-0.02y_2(t-1)u_1(t-1) \\
\end{matrix}
\end{equation}
Similar to the first example, datasets $D_N$ and $U_N$ are constructed, and corresponding disturbance sets $\mathbb{Y}_D$, $\mathbb{W}(x_D(t))$ and $\mathbb{W}_\Omega$ are extracted. As opposed to the first example however, the  open-loop minmax robust MPC formulation as presented in \cite{Lofberg:2003} is implemented, and is shown in \eqref{RMPC_W_minmax}:
\begin{equation}
\small
\begin{matrix}
\begin{aligned}
\underset{u(t+k),k=0,..,N_P}{\text{min}} \hspace{5pt} \underset{w(t+k),k=0,..,N_P}{\text{max}}
&  \hspace{10pt} \mathlarger{\sum\limits_{k=1}^{N_P}}\norm{\hat y(t+k)-r(t+k)}_1 \\ \hspace{-200pt}
\end{aligned} \vspace{-10pt}\\
\begin{aligned}
\text{subject to}
%\begin{matrix}
& \hspace{5pt} \hat{x}(t+k+1) = A\hat{x}(t+k) + B_Uu(t+k)+B_Ww(t+k)\\
& \hspace{5pt} \hat{y}(t+k) = C\hat{x}(t+k) + D_Uu(t+k)+D_Ww(t+k) \\
& \hspace{5pt} \hat{x}(t)=x(t) \\
& \hspace{5pt} \{\hat{y}(t+k),k=1,..,N_P\} \in \mathbb{Y} \\
& \hspace{5pt} \{w(t+k),k=0,..,N_P\} \in \mathbb{W}
%	& \hspace{20pt} Hy_{\gamma}(t) \leq h \mbox{\AB{I think $Hy_{\gamma}(t)\leq h$ is redundant}}\\
%	& \hspace{20pt}  g(t+k) \in \mathbb{G}_{N_P}(\gamma(t)) \\
%\end{matrix}
\end{aligned}
\end{matrix}
\label{RMPC_W_minmax}
\end{equation}
At each time step $t$, the state $x(t)$ is read, and either $\mathbb{W}=\mathbb{W}(x_D(t))$ or $\mathbb{W}=\mathbb{W}_{\Omega}$ is set. In the first case, before solving \eqref{RMPC_W_minmax}, the matrix-vector operations in \eqref{w_xd_set} are performed to calculate $\mathbb{W}(x_D(t))$. \\
The performance of the controllers implementing \eqref{RMPC_W_minmax} is compared with that implementing \eqref{RMPC_YD_minmax}, in which the uncertainty is modeled as simple output disturbance $y_D(t)$ constrained to lie within the set $\mathbb{Y}_D$. The matrix $D_Y=eye(ny)$, indicating that each output channel has a disturbance signal added to it.  This comparison is made to demonstrate the improvement in performance on using a disturbance model along with the nominal plant model for robust MPC. 
\begin{equation}
\small
\begin{matrix}
\begin{aligned}
\underset{u(t+k),k=0,..,N_P}{\text{min}} \hspace{5pt} \underset{y_D(t+k),k=0,..,N_P}{\text{max}}
&  \hspace{10pt} \mathlarger{\sum\limits_{k=1}^{N_P}}\norm{\hat y(t+k)-r(t+k)}_1 \\ \hspace{-200pt}
\end{aligned} \vspace{-10pt}\\
\begin{aligned}
\text{subject to}
%\begin{matrix}
& \hspace{5pt} \hat{x}_M(t+k+1) = A_M\hat{x}_M(t+k) + B_Mu(t+k)\\
& \hspace{5pt} \hat{y}(t+k) = C_M\hat{x}_M(t+k) + D_Mu(t+k)+D_Yy_D(t+k) \\
& \hspace{5pt} \hat{x}_M(t)=x_M(t) \\
& \hspace{5pt} \{\hat{y}(t+k),k=1,..,N_P\} \in \mathbb{Y} \\
& \hspace{5pt} \{y_D(t+k),k=0,..,N_P\} \in \mathbb{Y}_D
%	& \hspace{20pt} Hy_{\gamma}(t) \leq h \mbox{\AB{I think $Hy_{\gamma}(t)\leq h$ is redundant}}\\
%	& \hspace{20pt}  g(t+k) \in \mathbb{G}_{N_P}(\gamma(t)) \\
%\end{matrix}
\end{aligned}
\end{matrix}
\label{RMPC_YD_minmax}
\end{equation}
Since the matrices $A_M,B_M,C_M,D_M$ represent a non-minimal state space model of the $M(q^{-1})$, the state $x_M(t)$ of the model is updated by placing past plant outputs $\{y(k),k<t\}$ and inputs $\{u(k),k<t\}$ in a vector composing the system state.\\
 The output constraint set $\mathbb{Y}$ is composed of:
 \begin{equation}
 \small
 \mathbb{Y}=\begin{Bmatrix}y(t+k):\begin{bmatrix} 1 & 0 \\ 0 & 1 \\ -1 & 0 \\ 0 & -1 \end{bmatrix} y(t+k) \leq \begin{bmatrix} 0.5 \\ 0.5 \\ 0.5 \\ 0.5 \end{bmatrix}, k=1,..,N_P\end{Bmatrix}
 \end{equation}
and the output $y(t)$ of the plant should track the constant reference $r(t)=\begin{bmatrix} 0.5 & -0.5 \end{bmatrix} '$. A comparison of the performance of the different uncertainty descriptions in shown in Figure \ref{minmaxMPC}. It is clearly seen that using $\mathbb{W}(x_D(t))$ results in the least conservative performance, indicating that using a disturbance model improves robust MPC performance, and hence the calculation of uncertainty sets on $w(t)$ is justified.
\begin{figure}[h]
	\centering
\includegraphics[scale=0.6]{mimax_full.eps}
\caption{Performance comparison on using the three different uncertainty descriptions in minmax MPC}
\label{minmaxMPC}
\end{figure}
\section{Conclusion}
This paper presents a method to characterize the sets in which model uncertainty described as exogenous disturbances lies, along with a simple robust MPC scheme in which this uncertainty description can be used. The characterization of uncertainty sets builds on ARX identification of the plant, and is based on the premise that the prediction error of the identification process is directly related to model uncertainties. The robust MPC schemes are numerically validated, and were found to provide robust constraint satisfaction. 
A number of questions are to be researched on from this point. The first is the requirements to be satisfied for Assumption \ref{assmp_inf} to hold. Following this, analysis of the robust MPC schemes has to be performed. Some investigation into methods that could reduce conservatism of Algorithm \ref{alg:mpc_proj} is also to be done. Also, extensions are to be done to the methodology in cases when plant models other than ARX models are used, and the noisy output case should be tackled.
\section*{Appendix A}
\vspace{-10pt}
\noindent
\textit{Calculation of $\mathbb{X}^D$}: 
Let each output channel of the MIMO system \eqref{ssD} be indexed by $c$, and denoted as the scalar $y_D^c(t)$. Hence, $y_D(t)=[y_D^1(t) \hspace{4pt} y_D^2(t) \hspace{4pt} .. \hspace{4pt} y_D^{n_y}(t)]'$. Let the state $x_D(t)$ be composed of $h_c$ number of past values of the output $y_D^c(t)$ of channel $c$. 
To calculate the set $\mathbb{X}^D$ in which $x_D(t)$ lies, we first define $\bar{h}=max(h_c), c=1,..,n_y $. Then, we introduce a new vector $\bar{x}_D(t)$, which is the collection of all outputs channels till $\bar{h}$ time steps into the past. For example, if the number of output channels $n_y=3$, and dependence of state on past outputs is $h_1=3$, $h_2=2$ and $h_3=1$, the state $x_D(t)$ and the vector $\bar{x}_D(t)$ at time instant $t$ can be written as:
\begin{equation}
\small
\begin{matrix}
x_D(t) = \begin{bmatrix}
y_D^1(t-1) \\ y_D^2(t-1) \\ y_D^3(t-1) \\ y_D^1(t-2) \\ y_D^2(t-2) \\ y_D^1(t-3)
\end{bmatrix}
& 
\bar{x}_D(t) = \begin{bmatrix}
y_D^1(t-1) \\ y_D^2(t-1) \\ y_D^3(t-1) \\ y_D^1(t-2) \\ y_D^2(t-2) \\ \textcolor{red}{y_D^3(t-2)} \\ y_D^1(t-3) \\ \textcolor{red}{y_D^2(t-3)} \\ \textcolor{red}{y_D^3(t-3)}
\end{bmatrix}
\end{matrix}
\end{equation}
The set $\bar{\mathbb{X}}^D$ in which $\bar{x}_D(t)$ lies is defined as:
\begin{equation}
\small
\bar{\mathbb{X}}^D = \begin{Bmatrix}x_D(t): \begin{bmatrix} y_D^1(t-k) \\ y_D^2(t-k) \\ . \\ . \\ y_D^{n_y}(t-k) \end{bmatrix} \in \mathbb{Y}_D^{\infty} \hspace{5pt} \forall k=1,..,\bar{h} \end{Bmatrix}
\end{equation}
Using the polyhedral sets for point-wise in time constraint $\mathbb{Y}_D^{\infty}$, the set $\bar{\mathbb{X}}^D$ is written as:
\begin{equation}
\small
\bar{\mathbb{X}}^D = \begin{Bmatrix}x_D(t):\begin{bmatrix} H_D & . & . & 0 \\ . & H_D & . & . \\ . & . & . & . \\ 0 & . & . & H_D \end{bmatrix} \begin{bmatrix} y_D(t-1) \\ . \\ . \\ y_D(t-\bar{h}) \end{bmatrix} \leq \begin{bmatrix} h_D \\ . \\. \\ h_D \end{bmatrix}\end{Bmatrix}
\end{equation}
Since the state vector $x_D(t)$ is composed of a subset of dimensions of $\bar{x}_D(t)$, the set $\mathbb{X}^D$ in which $x_D(t)$ lies is hence a projection of $\bar{\mathbb{X}^D}$ onto those dimensions, given by:
\begin{equation}
\mathbb{X}^D = \text{proj}_{x_D(t)}(\bar{\mathbb{X}}^D)
\end{equation}
Further discussion on performing this projection operation is discussed in \cite{Predictivecontrol}.
\bibliography{references}
\end{document}